Running all tests...

> @dvcorg/cml@0.18.13 test:unit
> jest --testPathIgnorePatterns='e2e.test.js$' --forceExit --verbose --silent --no-coverage

Proxy listening on port 9093
PASS src/commenttarget.test.js
  comment target tests
    âœ“ qualified comment target: pr (6 ms)
    âœ“ qualified comment target: commit (1 ms)
    âœ“ qualified comment target: issue (1 ms)
    âœ“ qualified comment target: unsupported (2 ms)
    âœ“ legacy flag: commitSha (1 ms)
    âœ“ legacy flag: pr, context (4 ms)
    âœ“ legacy flag: pr, commit sha (2 ms)
    âœ“ unqualified flag: commit sha (1 ms)
    âœ“ unqualified flag: pr, context (2 ms)
    âœ“ unqualified flag: pr, commit sha (1 ms)
    âœ“ unqualified comment target: issue
    âœ“ auto comment target: pr context (1 ms)
    âœ“ auto comment target: pr, commit sha (1 ms)
    âœ“ auto comment target: fallback commit sha (1 ms)

PASS src/terraform.test.js
  Terraform tests
    âœ“ default options (10 ms)
    âœ“ basic settings (2 ms)
    âœ“ basic settings with runner forever (1 ms)
    âœ“ basic settings with metadata (2 ms)
    âœ“ basic settings with docker volumes (1 ms)
    âœ“ basic settings with permission set (1 ms)
    âœ“ Startup script (1 ms)

PASS bin/cml/comment/create.test.js
  Comment integration tests
    âœ“ cml send-comment --help (833 ms)

FAIL bin/cml/repo/prepare.test.js
  CML e2e
    âœ• cml-ci --help (940 ms)

  â— CML e2e â€º cml-ci --help

    expect(received).toMatchInlineSnapshot(snapshot)

    Snapshot name: `CML e2e cml-ci --help 1`

    - Snapshot  - 6
    + Received  + 0

    @@ -9,11 +9,5 @@
          [string] [choices: "github", "gitlab", "bitbucket"] [default: infer from the
                                                                          environment]
        --repo    Repository URL or slug[string] [default: infer from the environment]
        --token   Personal access token [string] [default: infer from the environment]
        --help    Show help                                                  [boolean]
    -
    - Options:
    -   --fetch-depth  Number of commits to fetch (use `0` for all branches & tags)
    -                                                                         [number]
    -   --user-email   Git user email        [string] [default: "olivaw@iterative.ai"]
    -   --user-name    Git user name                 [string] [default: "Olivaw[bot]"]

       5 |     const output = await exec('node', './bin/cml.js', 'ci', '--help');
       6 |
    >  7 |     expect(output).toMatchInlineSnapshot(`
         |                    ^
       8 |       "cml.js ci
       9 |
      10 |       Prepare Git repository for CML operations

      at Object.<anonymous> (bin/cml/repo/prepare.test.js:7:20)

 â€º 1 snapshot failed.
PASS bin/cml/asset/publish.test.js
  CML cli test
    âœ“ cml publish --help (930 ms)

PASS bin/cml/tensorboard/connect.test.js
  CML e2e
    âœ“ cml tensorboard-dev --help (902 ms)

PASS bin/cml/runner/launch.test.js
  CML e2e
    âœ“ cml-runner --help (842 ms)

PASS bin/cml/check/create.test.js
  CML e2e
    âœ“ cml send-github-check --help (889 ms)

PASS bin/cml/workflow/rerun.test.js
  CML e2e
    âœ“ cml-ci --help (909 ms)

PASS src/utils.test.js
  exec tests
    âœ“ exec is await and outputs hello (16 ms)
    âœ“ Command rejects if failure (7 ms)
  upload tests
    âœ“ image/png (685 ms)
    âœ“ application/pdf (538 ms)
    âœ“ image/svg+xml (549 ms)

PASS bin/cml.test.js
  command-line interface tests
    âœ“ cml --help (883 ms)
  Valid Docs URLs
    âœ“ Check Docs Link (137 ms)
    âœ“ Check Docs Link (105 ms)
    âœ“ Check Docs Link (125 ms)
    âœ“ Check Docs Link (771 ms)
    âœ“ Check Docs Link (72 ms)
    âœ“ Check Docs Link (58 ms)
    âœ“ Check Docs Link (57 ms)
    âœ“ Check Docs Link (54 ms)
    âœ“ Check Docs Link (55 ms)

Snapshot Summary
 â€º 1 snapshot failed from 1 test suite. Inspect your code changes or run `npm run test:unit -- -u` to update them.

Test Suites: 1 failed, 10 passed, 11 total
Tests:       1 failed, 42 passed, 43 total
Snapshots:   1 failed, 14 passed, 15 total
Time:        4.295 s
Teardown Jest. Stoping Proxy...
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
